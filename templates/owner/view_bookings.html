{% extends 'base.html' %}
{% block title %}All Bookings{% endblock %}

{% block content %}
<h2>All Bookings</h2>
<hr>
{% if bookings %}
  <table class="table table-striped">
    <thead>
      <tr>
        <th>ID</th>
        <th>Homestay</th>
        <th>Room</th>
        <th>Start</th>
        <th>End</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for booking in bookings %}
        <tr>
          <td>{{ booking.id }}</td>
          <td>{{ booking.homestay.title }}</td>
          <td>
            {% if booking.room %}
              Room #{{ booking.room.room_number }}
            {% else %}
              <em>No room assigned</em>
            {% endif %}
          </td>
          <td>{{ booking.start_time.strftime('%Y-%m-%d %H:%M') }}</td>
          <td>{{ booking.end_time.strftime('%Y-%m-%d %H:%M') }}</td>
          
          <!-- Cột hiển thị trạng thái bằng badge màu -->
          <td>
            {% if booking.status == 'pending' %}
              <span class="badge bg-warning">Pending</span>
            {% elif booking.status == 'confirmed' %}
              <span class="badge bg-primary">Confirmed</span>
            {% elif booking.status == 'active' %}
              <span class="badge bg-info">Active</span>
            {% elif booking.status == 'completed' %}
              <span class="badge bg-success">Completed</span>
            {% elif booking.status == 'cancelled' %}
              <span class="badge bg-danger">Cancelled</span>
            {% elif booking.status == 'rejected' %}
              <span class="badge bg-danger">Rejected</span>
            {% else %}
              <span class="badge bg-secondary">{{ booking.status|capitalize }}</span>
            {% endif %}
          </td>
          
          <!-- Cột các nút hành động tùy theo trạng thái -->
          <td>
            {% if booking.status == 'pending' %}
              <!-- Nút Confirm -->
              <a href="{{ url_for('owner.confirm_booking', id=booking.id) }}"
                 class="btn btn-success btn-sm me-1">
                Confirm
              </a>
              
              <!-- Nút Reject -->
              <a href="{{ url_for('owner.reject_booking', id=booking.id) }}"
                 class="btn btn-danger btn-sm">
                Reject
              </a>
              
            {% elif booking.status == 'confirmed' %}
              <!-- Nút Mark as Completed -->
              <a href="{{ url_for('owner.mark_completed', id=booking.id) }}"
                 class="btn btn-primary btn-sm">
                Mark as Completed
              </a>
              
            {% elif booking.status == 'active' %}
              <!-- Bạn có thể chọn hiển thị Mark as Completed hoặc hành động khác -->
              <a href="{{ url_for('owner.mark_completed', id=booking.id) }}"
                 class="btn btn-primary btn-sm">
                Mark as Completed
              </a>
              
            {% endif %}
            
            <!-- Link chi tiết booking, nếu cần -->
            <a href="{{ url_for('owner.booking_details', booking_id=booking.id) }}"
               class="btn btn-info btn-sm ms-1">
              Details
            </a>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
  <p>No bookings found.</p>
{% endif %}
{% endblock %}
