{% extends 'base.html' %}
{% block title %}All Bookings{% endblock %}

{% block content %}
<div class="container my-4">
    <h2>All Bookings</h2>
    <hr>
    
    {% if bookings %}
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead class="table-light">
            <tr>
              <th>ID</th>
              <th>Homestay</th>
              <th>Room</th>
              <!-- Remove the Renter column for now -->
              <th>Start</th>
              <th>End</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for booking in bookings %}
              <tr>
                <td>{{ booking.id }}</td>
                <td>{{ booking.room.homestay.title }}</td>
                <td>{{ booking.room.room_number }}</td>
                <!-- Remove the user.username cell -->
                <td>{{ booking.start_time.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>{{ booking.end_time.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>
                  {% if booking.status == 'pending' %}
                    <span class="badge bg-warning">Pending</span>
                  {% elif booking.status == 'confirmed' %}
                    <span class="badge bg-primary">Confirmed</span>
                  {% elif booking.status == 'active' %}
                    <span class="badge bg-info">Active</span>
                  {% elif booking.status == 'completed' %}
                    <span class="badge bg-success">Completed</span>
                  {% elif booking.status == 'cancelled' %}
                    <span class="badge bg-danger">Cancelled</span>
                  {% elif booking.status == 'rejected' %}
                    <span class="badge bg-danger">Rejected</span>
                  {% else %}
                    <span class="badge bg-secondary">{{ booking.status|capitalize }}</span>
                  {% endif %}
                </td>
                <td>
                  <div class="btn-group">
                    {% if booking.status == 'pending' %}
                      <a href="{{ url_for('owner.confirm_booking', id=booking.id) }}" class="btn btn-success btn-sm">
                        <i class="bi bi-check-circle"></i> Confirm
                      </a>
                      <a href="{{ url_for('owner.reject_booking', id=booking.id) }}" class="btn btn-danger btn-sm ms-1">
                        <i class="bi bi-x-circle"></i> Reject
                      </a>
                    {% elif booking.status == 'confirmed' %}
                      <a href="{{ url_for('owner.mark_completed', id=booking.id) }}" class="btn btn-primary btn-sm">
                        <i class="bi bi-check2-all"></i> Complete
                      </a>
                    {% endif %}
                    
                    {% if booking.id %}
                      <a href="{{ url_for('owner.booking_details', booking_id=booking.id) }}" class="btn btn-info btn-sm ms-1">
                        <i class="bi bi-info-circle"></i> Details
                      </a>
                    {% endif %}
                  </div>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="alert alert-info">
        <i class="bi bi-info-circle"></i> No bookings found.
      </div>
    {% endif %}
</div>
{% endblock %}
